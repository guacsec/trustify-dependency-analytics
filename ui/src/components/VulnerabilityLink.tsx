import { Vulnerability } from '../api/report';
import { issueLink } from '../utils/utils';
import { useAppContext } from '../App';

export const VulnerabilityLink = ({ sourceName: providerName, vulnerability }: { sourceName: string; vulnerability: Vulnerability }) => {
  const appContext = useAppContext();
  return (
    <>
      {vulnerability.remediation?.fixedIn === null || vulnerability.remediation?.fixedIn?.length === 0 ? (
        <p></p>
      ) : (
        <a href={issueLink(providerName, vulnerability.id, appContext)} target="_blank" rel="noreferrer">
          {vulnerability.id}
        </a>
      )}
    </>
  );
};
